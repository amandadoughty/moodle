define(["jquery"],function(a){var b,c={QUICKLINK:"a.dash-link",EDITLINK:"a.quicklinkedit"};a(".open-button").on("click",function(){a("ul.cul").find(".collapse").collapse("show")}),a(".close-button").on("click",function(){a("ul.cul").find(".collapse").collapse("hide")});var d=function(c,d,e,f){var g={courseid:d,name:e,value:f,sesskey:M.cfg.sesskey};window.console.log("change"),a.post(b,g,function(){}).done(function(a){try{var b=c.parent();c.remove(),templates.render("format_cul/editlink",a).done(function(a,c){templates.appendNodeContents(b,a,c)}).fail(notification.exception),b.hasClass("linkhidden")?b.removeClass("linkhidden"):b.addClass("linkhidden")}catch(d){notification.exception(d)}}).fail(function(a,b,c){notification.exception(c)})},e=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+b+"=([^&#]*)"),d=c.exec(a);return null===d?"":decodeURIComponent(d[1].replace(/\+/g," "))},f=function(b){b.preventDefault();var c=a(b.currentTarget),f=c.attr("href"),g=e(f,"courseid"),h=e(f,"name"),i=e(f,"value");d(c,g,h,i)};return{init:function(d){b=d;var e=a("body");e.delegate(c.EDITLINK,"click",f)}}});