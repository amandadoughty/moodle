define(["jquery","core/notification","core/templates"],function(a,b,c){var d,e={QUICKLINK:"a.dash-link",EDITLINK:"a.dashlinkedit"},f=function(e,f,g,h,i,j){var k={courseid:f,name:g,action:h,showhide:i,lnktxt:j,sesskey:M.cfg.sesskey};a.post(d,k,function(){}).done(function(a){try{var d=e.parent();e.remove(),c.render("format_culcourse/editlink",a).done(function(a,b){c.appendNodeContents(d,a,b)}).fail(b.exception),d.hasClass("linkhidden")?d.removeClass("linkhidden"):d.addClass("linkhidden")}catch(f){b.exception(f)}}).fail(function(a,c,d){b.exception(d)})},g=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+b+"=([^&#]*)"),d=c.exec(a);return null===d?"":decodeURIComponent(d[1].replace(/\+/g," "))},h=function(b){b.preventDefault();var c=a(b.currentTarget),d=c.attr("href"),e=g(d,"courseid"),h=g(d,"name"),i=g(d,"action"),j=g(d,"showhide"),k=c.attr("title");k=k.match(/'([^']+)'/)[1],f(c,e,h,i,j,k)};return{init:function(b){d=b;var c=a("body");c.delegate(e.EDITLINK,"click",h)}}});