define ("format_culcourse/sectiontoggle",["jquery","core/ajax","core/config","core/notification"],function(a,b,c,d){var f={OPENALLLINK:"a#toggles-all-opened",CLOSEALLLINK:"a#toggles-all-closed",SECTIONHEAD:".sectionhead",SECTIONBODY:".sectionbody",SECTIONFOOTER:".sectionclose",TOGGLEHEAD:".course-content #toggle-",TOGGLEBODY:"#togglesection-",TOGGLEFOOTER:".course-content #footertoggle-",DDPROXY:".yui3-dd-proxy",SECTIONNAME:".sectionname a"},g={SHOW:"show",COLLAPSE:"collapse",COLLAPSING:"collapsing",COLLAPSED:"collapsed"},h=c.wwwroot+"/course/format/culcourse/getuserprefsections.php",i=c.wwwroot+"/course/format/culcourse/setuserprefsections.php",j,k=function(b){b.preventDefault();b.stopPropagation();a("ul.culcourse").find(f.SECTIONBODY).collapse("show")},l=function(b){b.preventDefault();b.stopPropagation();a("ul.culcourse").find(f.SECTIONBODY).collapse("hide")},m=function(b){b.stopPropagation();if(a(this).is(b.target)){var c=a(b.currentTarget).data("preference-key"),d={courseid:j,sectionid:c,value:1};a.ajax(i,{type:"POST",dataType:"json",data:d});a(f.TOGGLEHEAD+c).removeClass(g.COLLAPSED).attr("aria-expanded",!0);a(f.TOGGLEFOOTER+c).removeClass(g.COLLAPSED).attr("aria-expanded",!0)}},n=function(b){b.stopPropagation();if(a(this).is(b.target)){var c=a(b.currentTarget).data("preference-key"),d={courseid:j,sectionid:c,value:0};a.ajax(i,{type:"POST",dataType:"json",data:d});a(f.TOGGLEHEAD+c).addClass(g.COLLAPSED).attr("aria-expanded",!1);a(f.TOGGLEFOOTER+c).addClass(g.COLLAPSED).attr("aria-expanded",!1)}};return{init:function init(b){j=b;var c=a("body");c.delegate(f.SECTIONNAME,"click",function(a){a.preventDefault()});c.delegate(f.OPENALLLINK,"click",k);c.delegate(f.CLOSEALLLINK,"click",l);c.delegate(f.SECTIONBODY,"hide.bs.collapse",n);c.delegate(f.SECTIONBODY,"show.bs.collapse",m);a.post(h,{courseid:b},function(){}).done(function(){a(f.SECTIONHEAD).addClass(g.COLLAPSED);a(f.SECTIONFOOTER).addClass(g.COLLAPSED);a(f.SECTIONBODY).removeClass(g.SHOW)}).then(function(b){var c=b;for(var d in c){if(1==c[d]){a(f.TOGGLEHEAD+d).removeClass(g.COLLAPSED);a(f.TOGGLEFOOTER+d).removeClass(g.COLLAPSED);a(f.TOGGLEBODY+d).addClass(g.SHOW)}}}).then(function(){a(document).trigger(a.Event("culcoursesectiontoggle"))}).fail(function(a,b,c){d.exception(c)})}}});
//# sourceMappingURL=sectiontoggle.min.js.map
