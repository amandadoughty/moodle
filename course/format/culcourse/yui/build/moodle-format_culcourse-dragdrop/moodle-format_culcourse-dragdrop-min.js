YUI.add("moodle-format_culcourse-dragdrop",function(e,t){var n=function(){n.superclass.constructor.apply(this,arguments)},r={ACTIONAREA:"dash-edit",ACTIONLINKCONTAINER:"activitylinks",DASHLINK:"dash",DASHLINKDRAGGABLE:"dashlinkdraggable",MOVE:"dash-move",QUICKLINKCONTAINER:"quicklinks"};e.extend(n,M.core.dragdrop,{goingup:null,initializer:function(){this.groups=[r.DASHLINKDRAGGABLE],this.dashlinklistselector="."+r.DASHLINK,this.setup_for_dashlink(this.dashlinklistselector),this.samenodeclass=r.DASHLINK,this.parentnodeclass=r.QUICKLINKCONTAINER;var t=new e.DD.Delegate({container:"."+r.QUICKLINKCONTAINER,nodes:"."+r.DASHLINKDRAGGABLE,target:!0,handles:["."+r.MOVE],dragConfig:{groups:this.groups}});t.dd.plug(e.Plugin.DDProxy,{moveOnEnd:!1,cloneNode:!0}),t.dd.plug(e.Plugin.DDConstrained,{constrain:"."+r.QUICKLINKCONTAINER}),t.dd.plug(e.Plugin.DDWinScroll);var t=new e.DD.Delegate({container:"."+r.ACTIONLINKCONTAINER,nodes:"."+r.DASHLINKDRAGGABLE,target:!0,handles:["."+r.MOVE],dragConfig:{groups:this.groups}});t.dd.plug(e.Plugin.DDProxy,{moveOnEnd:!1,cloneNode:!0}),t.dd.plug(e.Plugin.DDConstrained,{constrain:"."+r.ACTIONLINKCONTAINER}),t.dd.plug(e.Plugin.DDWinScroll)},setup_for_dashlink:function(t){e.Node.all(t).each(function(t){var n=t.getData("draggroups");n||(t.setAttribute("data-draggroups",this.groups.join(" ")),new e.DD.Drop({node:t,groups:this.groups,padding:"20 0 20 0"}));var i=t.one("a."+r.MOVE);i&&i.replace(this.get_drag_handle(M.util.get_string("movedashlink","format_culcourse"),r.MOVE,r.ICONCLASS,!0))},this)},drag_start:function(e){var t=e.target;t.get("dragNode").set("innerHTML",t.get("node").get("innerHTML"))},drag_drag:function(e){var t=e.target.lastXY[0];t<this.lastX?this.goingLeft=!0:this.goingLeft=!1,this.lastX=t},drag_dropmiss:function(e){this.drop_hit(e)},drop_over:function(e){var t=e.drag.get("node"),n=e.drop.get("node");n.hasClass(r.DASHLINK)&&(!this.goingLeft&&!this.goingUp&&(n=n.get("nextSibling")),e.drop.get("node").get("parentNode").insertBefore(t,n))},drop_hit:function(t){var n=t.drop.get("node"),i=t.drag.get("node"),s={},o=i.one("."+r.ACTIONAREA),u=M.util.add_spinner(e,o);n.hasClass(r.DASHLINK)||n.appendChild(i),s.sesskey=M.cfg.sesskey,s.courseid=this.get("courseid"),s.moveto=n.getData("position"),s.copy=i.getData("position"),s.action=2,s.name=i.getData("setting");var a=M.cfg.wwwroot+this.get("ajaxurl");e.io(a,{method:"POST",data:s,on:{start:function(){u.show()},success:function(e,t){window.setTimeout(function(){u.hide()},250)},failure:function(e,t){this.ajax_failure(t),u.hide()}},context:this})}},{NAME:"format_culcourse_dragdrop",ATTRS:{courseid:{value:null},ajaxurl:{value:0},config:{value:0}}}),M.format_culcourse=M.format_culcourse||{},M.format_culcourse.init_dragdrop=function(e){new n(e)}},"@VERSION@",{requires:["base","node","io","dom","dd","dd-scroll","moodle-core-dragdrop","moodle-core-notification","moodle-course-coursebase","moodle-course-util"]});
