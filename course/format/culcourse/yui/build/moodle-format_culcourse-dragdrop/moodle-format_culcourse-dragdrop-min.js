YUI.add("moodle-format_culcourse-dragdrop",function(e,t){var n=function(){n.superclass.constructor.apply(this,arguments)},r={QUICKLINK:"quick",QUICKLINKCONTAINER:"quicklinks",DASHLINK:"dash",QUICKLINKDRAGGABLE:"quicklinkdraggable",COURSECONTENT:"course-content",MOVE:"dash-move",ICONCLASS:"iconsmall"},i={QUICKLINK:".dash.quick",QUICKLINKCONTAINER:".links.quicklinks",COURSECONTENT:".course-content",ACTIVITYLINK:".dash.activity",ACTIVITYLINKCONTAINER:".links.activitylinks",MOVE:".dash-move",DASHLINK:".dash",QUICKLINKDRAGGABLE:".quicklinkdraggable"},s=M.cfg.wwwroot+"/course/format/culcourse/dashboard/dashlink_edit_ajax.php";e.extend(n,M.core.dragdrop,{goingup:null,initializer:function(){this.groups=[r.QUICKLINKDRAGGABLE],this.quicklinklistselector=i.QUICKLINK,this.setup_for_quicklink(this.quicklinklistselector),this.samenodeclass=r.QUICKLINK,this.parentnodeclass=r.QUICKLINKCONTAINER;var t=new e.DD.Delegate({container:i.QUICKLINKCONTAINER,nodes:i.QUICKLINKDRAGGABLE,target:!0,handles:[i.MOVE],dragConfig:{groups:this.groups}});t.dd.plug(e.Plugin.DDProxy,{moveOnEnd:!1,cloneNode:!0}),t.dd.plug(e.Plugin.DDConstrained,{constrain:i.QUICKLINKCONTAINER}),t.dd.plug(e.Plugin.DDWinScroll)},setup_for_quicklink:function(t){e.Node.all(t).each(function(t){var n=t.getData("draggroups");n||(t.setAttribute("data-draggroups",this.groups.join(" ")),new e.DD.Drop({node:t,groups:this.groups,padding:"20 0 20 0"}));var s=t.one("a"+i.MOVE);s&&s.replace(this.get_drag_handle(M.util.get_string("movecoursemodule","moodle"),r.MOVE,r.ICONCLASS,!0))},this)},drag_start:function(e){var t=e.target;t.get("node").addClass("drag_target_active"),t.get("dragNode").set("innerHTML",t.get("node").get("innerHTML")),t.get("dragNode").addClass("drag_item_active"),t.get("dragNode").setStyles({borderColor:t.get("node").getStyle("borderColor"),backgroundColor:t.get("node").getStyle("backgroundColor")})},drag_drag:function(e){var t=e.target.lastXY[0];t<this.lastX?this.goingLeft=!0:this.goingLeft=!1,this.lastX=t},drag_dropmiss:function(e){this.drop_hit(e)},drop_over:function(e){var t=e.drag.get("node"),n=e.drop.get("node");n.hasClass(r.QUICKLINK)&&(!this.goingLeft&&!this.goingUp&&(n=n.get("nextSibling")),e.drop.get("node").get("parentNode").insertBefore(t,n),e.drop.sizeShim())},drop_hit:function(t){var n=t.drop.get("node"),i=t.drag.get("node"),o={};!n.hasClass(r.QUICKLINK),o.sesskey=M.cfg.sesskey,o.courseid=7,o.moveto=n.getData("position"),o.copy=i.getData("position"),o.action=2,o.name="quicklinksequence",o.before=!0,e.io(s,{method:"POST",data:o,on:{start:function(){},success:function(e,t){},failure:function(e,t){this.ajax_failure(t)}},context:this})}},{NAME:"format_culcourse_dragdrop"}),M.format_culcourse=M.format_culcourse||{},M.format_culcourse.init_dragdrop=function(){new n}},"@VERSION@",{requires:["base","dd-constrain","dd-proxy","dd-drop","dd-delegate","dd-plugin"]});
