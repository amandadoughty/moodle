{"version":3,"sources":["../src/dashtoggle.js"],"names":["define","$","Ajax","config","Notification","SELECTORS","TOGGLELINK","DASHBOARD","GETURL","wwwroot","SETURL","courseId","handleOpen","e","stopPropagation","is","target","data","courseid","value","ajax","type","dataType","handleClose","init","body","delegate","post","done","addClass","removeClass","fail","jqXHR","status","error","exception"],"mappings":"AA4BAA,OAAM,wCAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,aAAxB,CAAuC,mBAAvC,CAAD,CAA8D,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAA0BC,CAA1B,CAAwC,IAMpGC,CAAAA,CAAS,CAAG,CACZC,UAAU,CAAE,6CADA,CAEZC,SAAS,CAAE,sCAFC,CANwF,CAWpGC,CAAM,CAAGL,CAAM,CAACM,OAAP,CAAiB,sDAX0E,CAYpGC,CAAM,CAAGP,CAAM,CAACM,OAAP,CAAiB,sDAZ0E,CAapGE,CAboG,CAsBpGC,CAAU,CAAG,SAASC,CAAT,CAAW,CACxBA,CAAC,CAACC,eAAF,GAEA,GAAIb,CAAC,CAAC,IAAD,CAAD,CAAQc,EAAR,CAAWF,CAAC,CAACG,MAAb,CAAJ,CAA0B,IAElBC,CAAAA,CAAI,CAAG,CACPC,QAAQ,CAAEP,CADH,CAEPQ,KAAK,GAFE,CAFW,CActBlB,CAAC,CAACmB,IAAF,CAAOV,CAAP,CANe,CACXW,IAAI,CAAE,MADK,CAEXC,QAAQ,CAAE,MAFC,CAGXL,IAAI,CAAEA,CAHK,CAMf,CAKH,CACJ,CA7CuG,CAsDpGM,CAAW,CAAG,SAASV,CAAT,CAAW,CACzBA,CAAC,CAACC,eAAF,GAEA,GAAIb,CAAC,CAAC,IAAD,CAAD,CAAQc,EAAR,CAAWF,CAAC,CAACG,MAAb,CAAJ,CAA0B,IAClBC,CAAAA,CAAI,CAAG,CACPC,QAAQ,CAAEP,CADH,CAEPQ,KAAK,GAFE,CADW,CAatBlB,CAAC,CAACmB,IAAF,CAAOV,CAAP,CANe,CACXW,IAAI,CAAE,MADK,CAEXC,QAAQ,CAAE,MAFC,CAGXL,IAAI,CAAEA,CAHK,CAMf,CACH,CACJ,CAxEuG,CA0ExG,MAAiE,CAM7DO,IAAI,CAAG,cAASN,CAAT,CAAmB,CACtBP,CAAQ,CAAGO,CAAX,CACA,GAAIO,CAAAA,CAAI,CAAGxB,CAAC,CAAC,MAAD,CAAZ,CAEAwB,CAAI,CAACC,QAAL,CAAcrB,CAAS,CAACE,SAAxB,CAAmC,kBAAnC,CAAuDgB,CAAvD,EACAE,CAAI,CAACC,QAAL,CAAcrB,CAAS,CAACE,SAAxB,CAAmC,kBAAnC,CAAuDK,CAAvD,EAQAX,CAAC,CAAC0B,IAAF,CAAOnB,CAAP,CALa,CACTU,QAAQ,CAAEA,CADD,CAKb,CAAuB,UAAW,CAAE,CAApC,EACKU,IADL,CACU,SAASX,CAAT,CAAe,CAGjB,GAAI,CAACA,CAAL,CAAW,CAEPhB,CAAC,CAACI,CAAS,CAACE,SAAX,CAAD,CAAuBsB,QAAvB,CAAgC,WAAhC,EACA5B,CAAC,CAACI,CAAS,CAACE,SAAX,CAAD,CAAuBuB,WAAvB,CAAmC,MAAnC,CACH,CAEJ,CAVL,EAWKC,IAXL,CAWU,SAASC,CAAT,CAAgBC,CAAhB,CAAwBC,CAAxB,CAA+B,CACjC9B,CAAY,CAAC+B,SAAb,CAAuBD,CAAvB,CACH,CAbL,CAcH,CAjC4D,CAmCpE,CA7GK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Dashboard toggle functions for CUL Course Format\n *\n * @package    course/format\n * @subpackage cul\n * @copyright  2016 Amanda Doughty <amanda.doughty.1@city.ac.uk>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n */\n\n/**\n * @module local_culcourse_dashboard/sectiontoggle\n */\ndefine(['jquery', 'core/ajax', 'core/config', 'core/notification'], function($, Ajax, config, Notification) {\n\n     /**\n      * Used CSS selectors\n      * @access private\n      */\n    var SELECTORS = {\n        TOGGLELINK: 'a#local_culcourse_dashboard_toggledashboard',\n        DASHBOARD: '#local_culcourse_dashboard_dashboard'\n        };\n\n    var GETURL = config.wwwroot + '/local/culcourse_dashboard/getuserprefdashtoggle.php';\n    var SETURL = config.wwwroot + '/local/culcourse_dashboard/setuserprefdashtoggle.php';\n    var courseId;\n\n    /**\n     * Saves user preference.\n     *\n     * @access private\n     * @method handleOpen\n     * @param {event} e\n     */\n    var handleOpen = function(e){\n        e.stopPropagation();\n\n        if ($(this).is(e.target)) {\n\n            var data = {\n                courseid: courseId,\n                value: true,\n                // sesskey: config.sesskey,\n            };\n\n            var settings = {\n                type: 'POST',\n                dataType: 'json',\n                data: data\n            };\n\n            $.ajax(SETURL, settings);\n                // .fail(function (request, status, error) {\n                //     Notification.exception(request);\n                //     console.log(error);\n                // });\n        }\n    };\n\n    /**\n     * Saves user preference.\n     *\n     * @access private\n     * @method handleClose\n     * @param {event} e\n     */\n    var handleClose = function(e){\n        e.stopPropagation();\n\n        if ($(this).is(e.target)) {\n            var data = {\n                courseid: courseId,\n                value: false,\n                // sesskey: config.sesskey,\n            };\n\n            var settings = {\n                type: 'POST',\n                dataType: 'json',\n                data: data\n            };\n\n            $.ajax(SETURL, settings);\n        }\n    };\n\n    return /** @alias module:local_culcourse_dashboard/dashtoggle */ {\n        /**\n         * Initialize dashtogglemanager\n         * @access public\n         * @param {int} courseid\n         */\n        init : function(courseid) {\n            courseId = courseid;\n            var body = $('body');\n\n            body.delegate(SELECTORS.DASHBOARD, 'hide.bs.collapse', handleClose);\n            body.delegate(SELECTORS.DASHBOARD, 'show.bs.collapse', handleOpen);\n\n            // Get the userprefs. They are too large to pass to the function.\n            var params = {\n                courseid: courseid,\n                // userid: userid,\n                // sesskey: M.cfg.sesskey\n            };\n            $.post(GETURL, params, function() {})\n                .done(function(data) {\n\n                    // If expanded is set to false then hide the dashboard.\n                    if (!data) {\n                        // $(SELECTORS.DASHBOARD).collapse('hide');\n                        $(SELECTORS.DASHBOARD).addClass('collapsed');\n                        $(SELECTORS.DASHBOARD).removeClass('show');\n                    }\n\n                })\n                .fail(function(jqXHR, status, error) {\n                    Notification.exception(error);\n                });\n        }\n    };\n});"],"file":"dashtoggle.min.js"}