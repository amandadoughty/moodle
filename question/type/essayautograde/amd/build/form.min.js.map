{"version":3,"sources":["../src/form.js"],"names":["define","$","FORM","sizewidths","init","init_target_phrases","init_add_button","each","keyup","sizewidth","size","attr","elm","document","createElement","css","hide","appendTo","outerWidth","remove","txt","createTextNode","val","append","w","Math","max","width","triggerHandler","name","anchor","click","url","closest","prop","replace"],"mappings":"AAwBAA,OAAM,6BAAC,CAAC,QAAD,CAAD,CAAa,SAASC,CAAT,CAAY,CAG3B,GAAIC,CAAAA,CAAI,CAAG,CAGNC,UAHM,IAAX,CAQAD,CAAI,CAACE,IAAL,CAAY,UAAW,CACnBF,CAAI,CAACG,mBAAL,GACAH,CAAI,CAACI,eAAL,CAAqB,UAArB,CAAiC,eAAjC,EACAJ,CAAI,CAACI,eAAL,CAAqB,YAArB,CAAmC,kBAAnC,CACH,CAJD,CAUAJ,CAAI,CAACG,mBAAL,CAA2B,UAAW,CAClCJ,CAAC,CAAC,4BAAD,CAAD,CAAgCM,IAAhC,CAAqC,UAAU,CAC3CN,CAAC,CAAC,IAAD,CAAD,CAAQO,KAAR,CAAc,UAAU,IAEhBC,CAAAA,CAAS,CAAG,CAFI,CAGhBC,CAAI,CAAGT,CAAC,CAAC,IAAD,CAAD,CAAQU,IAAR,CAAa,MAAb,CAHS,CAIpB,GAAID,CAAJ,CAAU,CACN,GAAIA,CAAI,GAAIR,CAAAA,CAAI,CAACC,UAAjB,CAA6B,CACzBM,CAAS,CAAGP,CAAI,CAACC,UAAL,CAAgBO,CAAhB,CACf,CAFD,IAEO,CACH,GAAIE,CAAAA,CAAG,CAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAV,CACAb,CAAC,CAACW,CAAD,CAAD,CAAOD,IAAP,CAAY,MAAZ,CAAoBD,CAApB,EACAT,CAAC,CAACW,CAAD,CAAD,CAAOG,GAAP,CAAW,OAAX,CAAoB,MAApB,EACAd,CAAC,CAACW,CAAD,CAAD,CAAOI,IAAP,GAAcC,QAAd,CAAuB,MAAvB,EACAR,CAAS,CAAGR,CAAC,CAACW,CAAD,CAAD,CAAOM,UAAP,EAAZ,CACAjB,CAAC,CAACW,CAAD,CAAD,CAAOO,MAAP,GACAjB,CAAI,CAACC,UAAL,CAAgBO,CAAhB,EAAwBD,CAC3B,CACJ,CAhBmB,GAkBhBW,CAAAA,CAAG,CAAGP,QAAQ,CAACQ,cAAT,CAAwBpB,CAAC,CAAC,IAAD,CAAD,CAAQqB,GAAR,EAAxB,CAlBU,CAmBhBV,CAAG,CAAGC,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAnBU,CAoBpBb,CAAC,CAACW,CAAD,CAAD,CAAOW,MAAP,CAAcH,CAAd,EAAmBJ,IAAnB,GAA0BC,QAA1B,CAAmC,MAAnC,EACA,GAAIO,CAAAA,CAAC,CAAGC,IAAI,CAACC,GAAL,CAASzB,CAAC,CAACW,CAAD,CAAD,CAAOe,KAAP,EAAT,CAAyBlB,CAAzB,CAAR,CACAR,CAAC,CAACW,CAAD,CAAD,CAAOO,MAAP,GACAlB,CAAC,CAAC,IAAD,CAAD,CAAQ0B,KAAR,CAAcH,CAAd,CACH,CAxBD,EAyBAvB,CAAC,CAAC,IAAD,CAAD,CAAQ2B,cAAR,CAAuB,OAAvB,CACH,CA3BD,CA4BH,CA7BD,CAmCA1B,CAAI,CAACI,eAAL,CAAuB,SAASuB,CAAT,CAAeC,CAAf,CAAuB,CAC1C7B,CAAC,CAAC,cAAgB4B,CAAhB,CAAuB,GAAxB,CAAD,CAA8BE,KAA9B,CAAoC,UAAU,CAC1C,GAAIC,CAAAA,CAAG,CAAG/B,CAAC,CAAC,IAAD,CAAD,CAAQgC,OAAR,CAAgB,MAAhB,EAAwBC,IAAxB,CAA6B,QAA7B,CAAV,CACAF,CAAG,CAAGA,CAAG,CAACG,OAAJ,QAAgC,EAAhC,CAAN,CACAlC,CAAC,CAAC,IAAD,CAAD,CAAQgC,OAAR,CAAgB,MAAhB,EAAwBC,IAAxB,CAA6B,QAA7B,CAAuCF,CAAG,CAAG,GAAN,CAAYF,CAAnD,CACH,CAJD,CAKH,CAND,CAQA,MAAO5B,CAAAA,CACV,CAjEK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the term of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * javascript for Essay (autograde) edit form\n *\n * @module      qtype_essayautograde/form\n * @category    output\n * @copyright   2018 Gordon Bateson (gordon.bateson@gmail.com)\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since       Moodle 3.0\n */\ndefine([\"jquery\"], function($) {\n\n    /** @alias module:qtype_essayautograde/form */\n    var FORM = {};\n\n    // cache for standard width of TEXT input elements\n    FORM.sizewidths = new Array();\n\n    /**\n     * initialize this AMD module\n     */\n    FORM.init = function() {\n        FORM.init_target_phrases();\n        FORM.init_add_button(\"addbands\", \"id_gradebands\");\n        FORM.init_add_button(\"addphrases\", \"id_targetphrases\");\n    };\n\n    /**\n     * Make the target phrase text boxes \"expandable\",\n     * i.e. expand/contract to fit the width of the content\n     */\n    FORM.init_target_phrases = function() {\n        $(\"input[id^=id_phrasematch_]\").each(function(){\n            $(this).keyup(function(){\n                // get min width for a box with this \"size\"\n                var sizewidth = 0;\n                var size = $(this).attr(\"size\");\n                if (size) {\n                    if (size in FORM.sizewidths) {\n                        sizewidth = FORM.sizewidths[size];\n                    } else {\n                        var elm = document.createElement(\"INPUT\");\n                        $(elm).attr(\"size\", size);\n                        $(elm).css(\"width\", \"auto\");\n                        $(elm).hide().appendTo(\"BODY\");\n                        sizewidth = $(elm).outerWidth();\n                        $(elm).remove();\n                        FORM.sizewidths[size] = sizewidth;\n                    }\n                }\n                // get required width for this text value\n                var txt = document.createTextNode($(this).val());\n                var elm = document.createElement(\"SPAN\");\n                $(elm).append(txt).hide().appendTo(\"BODY\");\n                var w = Math.max($(elm).width(), sizewidth);\n                $(elm).remove();\n                $(this).width(w);\n            });\n            $(this).triggerHandler(\"keyup\");\n        });\n    };\n\n    /**\n     * modify an \"add\" button so that the page scrolls down\n     * to the appropriate anchor when it reloads\n     */\n    FORM.init_add_button = function(name, anchor) {\n        $(\"input[name=\" + name + \"]\").click(function(){\n            var url = $(this).closest(\"form\").prop(\"action\");\n            url = url.replace(new RegExp(\"#.*$\"), \"\");\n            $(this).closest(\"form\").prop(\"action\", url + \"#\" + anchor);\n        });\n    };\n\n    return FORM;\n});\n"],"file":"form.min.js"}