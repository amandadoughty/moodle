define(["jquery","core/ajax","core/templates","core/notification","core/str","core/url","core/yui","core/pubsub","core_course/events","block_myoverview/main","block_starredcourses/main"],function(o,e,t,r,a,c,s,i,n,u,l){var f=null,v=function(e){e.preventDefault();var t=e.target.get("href").split("?"),a=t[0],c=t[1];s.use("node","querystring-parse","json-parse",function(){s.io(M.cfg.wwwroot+"/theme/cul_boost/favourite_ajax.php",{method:"POST",context:this,data:c,on:{success:function(e,t){data=s.JSON.parse(t.responseText);var o=f.one("a"),r=a+"?"+c.replace(data.action,data.newaction);o.setAttribute("data-content",data.text),o.toggleClass("favourited"),o.set("href",r)},end:function(){s.fire("culcourse-listing:update-favourites");var e=o(".block_myoverview .block-myoverview");o.each(e,function(e,t){u.init(t)});e=o(".block_starredcourses .block-starredcourses");o.each(e,function(e,t){l.init(t)})}}})})};return{init:function(){s.one("#theme-cul_boost-removefromfavourites")?(f=s.one("#theme-cul_boost-removefromfavourites")).on("click",v,this):s.one("#theme-cul_boost-addtofavourites")&&(f=s.one("#theme-cul_boost-addtofavourites")).on("click",v,this),s.publish("culcourse-listing:update-favourites",{broadcast:2})}}});