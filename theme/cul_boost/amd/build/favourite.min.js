define(["jquery","core/ajax","core/templates","core/notification","core/str","core/url","core/yui","core/pubsub","core_course/events","block_myoverview/main","block_starredcourses/main"],function(t,e,o,r,c,s,n,i,a,u,l){"use strict";function f(e){e.preventDefault();var o=e.target.get("href").split("?"),s=o[0],i=o[1];n.use("node","querystring-parse","json-parse",function(){n.io(M.cfg.wwwroot+"/theme/cul_boost/favourite_ajax.php",{method:"POST",context:this,data:i,on:{success:function(e,o){var t=n.JSON.parse(o.responseText),r=v.one("a"),c=s+"?"+i.replace(t.action,t.newaction);r.setAttribute("data-content",t.text),r.toggleClass("favourited"),r.set("href",c)},end:function(){n.fire("culcourse-listing:update-favourites");var e=t(".block_myoverview .block-myoverview");t.each(e,function(e,o){u.init(o)}),e=t(".block_starredcourses .block-starredcourses"),t.each(e,function(e,o){l.init(o)})}}})})}var v=null;return{init:function(){n.one("#theme-cul_boost-removefromfavourites")?(v=n.one("#theme-cul_boost-removefromfavourites")).on("click",f,this):n.one("#theme-cul_boost-addtofavourites")&&(v=n.one("#theme-cul_boost-addtofavourites")).on("click",f,this),n.publish("culcourse-listing:update-favourites",{broadcast:2})}}});