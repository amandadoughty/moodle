{"version":3,"sources":["../src/favourites.js"],"names":["define","$","ajax","templates","Notification","str","url","Y","PubSub","CourseEvents","URL","M","cfg","wwwroot","updateFavourites","success","response","favourites","remove","newnode","parseHTML","existingnode","after","error","complete","fail","exception","init","use","Global","on","subscribe","favourited","unfavorited"],"mappings":"AAuBAA,OAAM,8BAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,gBAAxB,CAA0C,mBAA1C,CAA+D,UAA/D,CACH,UADG,CACS,UADT,CACqB,aADrB,CACoC,oBADpC,CAAD,CAEF,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAA6BC,CAA7B,CAA2CC,CAA3C,CAAgDC,CAAhD,CAAqDC,CAArD,CAAwDC,CAAxD,CAAgEC,CAAhE,CAA8E,CAE9E,aAF8E,GAI1EC,CAAAA,CAAG,CAAGC,CAAC,CAACC,GAAF,CAAMC,OAAN,CAAgB,sCAJoD,CAM1EC,CAAgB,CAAG,UAAY,CAC/Bb,CAAC,CAACC,IAAF,CAAO,CACHI,GAAG,CAAEI,CADF,CAEHK,OAAO,CAAE,iBAASC,CAAT,CAAmB,CACxB,GAAIC,CAAAA,CAAU,CAAGhB,CAAC,CAAC,+BAAD,CAAlB,CAEA,GAAIgB,CAAJ,CAAgB,CACZA,CAAU,CAACC,MAAX,EACH,CAED,GAAIF,CAAJ,CAAc,IAENG,CAAAA,CAAO,CAAGlB,CAAC,CAACmB,SAAF,CAAYJ,CAAZ,CAFJ,CAGNK,CAAY,CAAGpB,CAAC,CAAC,0CAAD,CAHV,CAIVoB,CAAY,CAACC,KAAb,CAAmBH,CAAnB,CACH,CACJ,CAfE,CAgBHI,KAAK,CAAE,gBAAW,CAEjB,CAlBE,CAmBHC,QAAQ,CAAE,mBAAW,CACpB,CApBE,CAAP,EAqBGC,IArBH,CAqBQrB,CAAY,CAACsB,SArBrB,CAsBH,CA7B6E,CA+B9E,MAAO,CACHC,IAAI,CAAE,eAAY,CACdpB,CAAC,CAACqB,GAAF,CAAM,MAAN,CAAc,UAAW,CACrBrB,CAAC,CAACsB,MAAF,CAASC,EAAT,CAAY,qCAAZ,CAAmDhB,CAAnD,CACH,CAFD,EAIAN,CAAM,CAACuB,SAAP,CAAiBtB,CAAY,CAACuB,UAA9B,CAA0C,UAAW,CAAClB,CAAgB,EAAI,CAA1E,EACAN,CAAM,CAACuB,SAAP,CAAiBtB,CAAY,CAACwB,WAA9B,CAA2C,UAAW,CAACnB,CAAgB,EAAI,CAA3E,CACH,CARE,CAUV,CA3CK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * A javascript module to ...\n *\n * @package    theme_cul_boost\n * @copyright  2019 Amanda Doughty\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/templates', 'core/notification', 'core/str', \n    'core/url', 'core/yui', 'core/pubsub', 'core_course/events'],\n    function($, ajax, templates, Notification, str, url, Y, PubSub, CourseEvents) {\n\n    \"use strict\";\n    // @TODO Replace all the YUI in theme_cul_boost and block_culcourse_listing.\n    var URL = M.cfg.wwwroot + '/theme/cul_boost/favourites_ajax.php';\n\n    var updateFavourites = function () {\n        $.ajax({\n            url: URL,\n            success: function(response) {\n                var favourites = $('#theme_cul_boost_myfavourites');                \n\n                if (favourites) {\n                    favourites.remove();\n                }\n\n                if (response) {\n                    // TODO use fragment.\n                    var newnode = $.parseHTML(response);\n                    var existingnode = $('.navbar .nav-wrap .nav-inner >a.nav-item');                    \n                    existingnode.after(newnode);\n                }\n            },\n            error: function() {\n\n            },\n            complete: function() {\n            }\n        }).fail(Notification.exception);\n    };\n\n    return {\n        init: function () {\n            Y.use('node', function() {\n                Y.Global.on('culcourse-listing:update-favourites', updateFavourites);\n            });\n\n            PubSub.subscribe(CourseEvents.favourited, function() {updateFavourites();});\n            PubSub.subscribe(CourseEvents.unfavorited, function() {updateFavourites();});\n        }\n    };\n});"],"file":"favourites.min.js"}