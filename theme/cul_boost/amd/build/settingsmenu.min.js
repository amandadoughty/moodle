define(["jquery","core/log"],function(h,e){return{init:function(){var d=h("#block-region-nav-settings");h(document).ajaxComplete(function(e,a,t){var i,s,n=h(".tree_item.branch"),r=h(".block_tree.list"),o=r.outerWidth(),l=n.siblings("ul");h("a.trigger").on("click",function(){var e;h(this).addClass("open"),d.addClass("show"),h(".overlay").addClass("show"),h("body").addClass("overflow-hidden"),1!=d.parents(".right-navbar").hasClass("stick")&&h("html, body").animate({scrollTop:d.offset().top},500),e=2*h('.tree_item.branch[aria-expanded="true"]').length,r.css("width","calc("+o+"px + "+e+"rem"),r.animate({scrollTop:0},0)}),h(".overlay").on("click",function(){d.removeClass("show"),h(this).removeClass("show"),h("body").removeClass("overflow-hidden")}),h(document).keyup(function(e){27==e.keyCode&&(d.removeClass("show"),h(".overlay").removeClass("show"),h("body").removeClass("overflow-hidden"))}),n.on("click",function(){var e,a,t,i,s;e=h(this),a=e.hasClass("root_node"),t=e.siblings("ul").find(".tree_item.branch"),i=e.parent().siblings(),s=2*e.parents("li.contains_branch").length,"true"==e.attr("aria-expanded")&&(s-=2),t.attr("aria-expanded","false"),t.siblings("ul").attr("aria-hidden","true"),i.find(".tree_item.branch").attr("aria-expanded","false"),i.find(".tree_item.branch").siblings("ul").attr("aria-hidden","true"),1!=a?r.css("width","calc("+o+"px + "+s+"rem"):r.css("width",o),r.animate({scrollTop:0},0)}),s=0,(i=l).each(function(){s=h(this).outerHeight()>s?h(this).height():s}),i.height(s),r.height(s)})}}});