{"version":3,"sources":["../src/settingsmenu.js"],"names":["define","$","init","settingsblock","document","ajaxComplete","branch","blocktree","width","outerWidth","sibling","siblings","maxheight","element","each","outerHeight","height","closenav","e","rootnode","hasClass","children","find","sib","parent","level","parents","length","attr","css","fix_width","openbranch","branches","on","addClass","scrollto","animate","scrollTop","offset","top","removeClass","keyup","keyCode"],"mappings":"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","sourcesContent":["/* jshint ignore:start */\ndefine(['jquery', 'core/log'], function($, log) {\n    return {\n        init: function() {\n\n            // Open/Close Settings Menu\n            var settingsblock = $('#block-region-nav-settings');\n\n            // Settings Menu Horizontal Feature\n            // Init / re-init the menu\n            $(document).ajaxComplete(function(event, xhr, settings) {\n\n                // Settings Menu Horizontal Feature\n                var branch = $('.tree_item.branch');\n                var blocktree = $('.block_tree.list');\n                var width = blocktree.outerWidth();\n                var sibling = branch.siblings('ul');\n\n                // Increase all branch list height to the tallest\n                function maxheight(element) {\n                    var maxheight = 0;\n                    element.each(function() {\n                        maxheight = ($(this).outerHeight() > maxheight ? $(this).height() : maxheight);\n                    });\n                    element.height(maxheight);\n                    blocktree.height(maxheight);\n                }\n\n                // Events that create the horizontal navigation\n                // by targeting the aria attributes\n                function closenav(e) {\n                    var rootnode = e.hasClass('root_node');\n                    var children = e.siblings('ul').find('.tree_item.branch');\n                    var sib = e.parent().siblings();\n                    var level = e.parents('li.contains_branch').length * 2;\n\n                    if (e.attr('aria-expanded') == 'true') {\n                        level = level - 2;\n                    }\n\n                    children.attr('aria-expanded', 'false');\n                    children.siblings('ul').attr('aria-hidden', 'true');\n                    sib.find('.tree_item.branch').attr('aria-expanded', 'false');\n                    sib.find('.tree_item.branch').siblings('ul').attr('aria-hidden', 'true');\n\n                    blocktree.css('width', 'calc(' + width + 'px + ' + level + 'rem');\n                }\n\n                function fix_width() {\n                    var openbranch = $('.tree_item.branch[aria-expanded=\"true\"]');\n                    var branches = openbranch.length * 2;\n                    blocktree.css('width', 'calc(' + width + 'px + ' + branches + 'rem');\n                }\n\n                $('a.trigger').on('click', function() {\n\n                    $(this).addClass('open');\n                    settingsblock.addClass('show');\n                    $('.overlay').addClass('show');\n                    $('body').addClass('overflow-hidden');\n\n                    var scrollto = settingsblock.parents('.right-navbar').hasClass('stick');\n                    if (scrollto != true) {\n                        $('html, body').animate({\n                            scrollTop: settingsblock.offset().top\n                        }, 200);\n                    }\n\n                    fix_width();\n\n                    // Click the settings button to reset navigation tree\n                    blocktree.animate({\n                        scrollTop: 0\n                    }, 0);\n                });\n\n                $('.overlay').on('click', function() {\n                    settingsblock.removeClass('show');\n                    $(this).removeClass('show');\n                    $('body').removeClass('overflow-hidden');\n                });\n\n                // Close the settings menu with ESC key\n                $(document).keyup(function(e) {\n                    if (e.keyCode == 27) {\n                        settingsblock.removeClass('show');\n                        $('.overlay').removeClass('show');\n                        $('body').removeClass('overflow-hidden');\n                    }\n                });\n\n                // Click branch to open submenu and scroll to the top\n                branch.on('click', function() {\n                    closenav($(this));\n                    blocktree.animate({\n                        scrollTop: 0\n                    }, 0);\n\n                });\n\n                // Call again just in case\n                maxheight(sibling);\n            });\n\n        }\n    }\n});\n/* jshint ignore:end */"],"file":"settingsmenu.min.js"}