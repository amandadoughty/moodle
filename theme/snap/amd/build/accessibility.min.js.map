{"version":3,"sources":["../src/accessibility.js"],"names":["define","$","str","init","get_strings","key","component","done","stringsjs","parent","attr","document","ready","Tabpanel","id","_id","$tpanel","$tabs","find","$panels","bindHandlers","prototype","keys","left","up","right","down","$tab","removeClass","filter","first","addClass","switchTabs","$curTab","$newTab","$curTabLink","$newTabLink","focus","self","keydown","e","handleTabKeyDown","click","handleTabClick","tabIndex","keyCode","index","last","eq","preventDefault","length","$oldTab"],"mappings":"AAyBAA,OAAM,4BAAC,CAAC,QAAD,CAAW,UAAX,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAiB,CACb,MAAO,CACHC,IAAI,CAAE,eAAW,CAEbD,CAAG,CAACE,WAAJ,CAAgB,CACZ,CAACC,GAAG,CAAG,qBAAP,CAA8BC,SAAS,CAAG,YAA1C,CADY,CAEZ,CAACD,GAAG,CAAG,qBAAP,CAA8BC,SAAS,CAAG,YAA1C,CAFY,CAGZ,CAACD,GAAG,CAAG,UAAP,CAAmBC,SAAS,CAAG,UAA/B,CAHY,CAAhB,EAIGC,IAJH,CAIQ,SAASC,CAAT,CAAoB,CAExBP,CAAC,CAAC,eAAD,CAAD,CAAmBQ,MAAnB,GAA4BC,IAA5B,CAAiC,YAAjC,CAA+CF,CAAS,CAAC,CAAD,CAAxD,EACAP,CAAC,CAAC,2CAAD,CAAD,CAA+CS,IAA/C,CAAoD,YAApD,CAAkEF,CAAS,CAAC,CAAD,CAA3E,EACA,GAAIP,CAAC,CAAC,yBAAD,CAAL,CAAkC,CAC9BA,CAAC,CAAC,wCAAD,CAAD,CAA4CS,IAA5C,CAAiD,YAAjD,CAA+DF,CAAS,CAAC,CAAD,CAAxE,EACAP,CAAC,CAAC,kCAAD,CAAD,CAAsCS,IAAtC,CAA2C,YAA3C,CAAyDF,CAAS,CAAC,CAAD,CAAlE,CACH,CACJ,CAZD,EAeAP,CAAC,CAACU,QAAD,CAAD,CAAYC,KAAZ,CAAkB,UAAW,CACzB,GAAIC,CAAAA,CAAJ,CAAa,wBAAb,EACA,GAAIA,CAAAA,CAAJ,CAAa,2BAAb,CACH,CAHD,EAKA,QAASA,CAAAA,CAAT,CAAkBC,CAAlB,CAAsB,CAClB,KAAKC,GAAL,CAAWD,CAAX,CACA,KAAKE,OAAL,CAAef,CAAC,CAAC,IAAMa,CAAP,CAAhB,CACA,KAAKG,KAAL,CAAa,KAAKD,OAAL,CAAaE,IAAb,CAAkB,MAAlB,CAAb,CACA,KAAKC,OAAL,CAAe,KAAKH,OAAL,CAAaE,IAAb,CAAkB,WAAlB,CAAf,CAEA,KAAKE,YAAL,GACA,KAAKjB,IAAL,EACH,CAEDU,CAAQ,CAACQ,SAAT,CAAmBC,IAAnB,CAA0B,CACtBC,IAAI,CAAE,EADgB,CAEtBC,EAAE,CAAE,EAFkB,CAGtBC,KAAK,CAAE,EAHe,CAItBC,IAAI,CAAE,EAJgB,CAA1B,CAOAb,CAAQ,CAACQ,SAAT,CAAmBlB,IAAnB,CAA0B,UAAW,CACjC,GAAIwB,CAAAA,CAAJ,CAEA,KAAKR,OAAL,CAAaT,IAAb,CAAkB,aAAlB,CAAiC,MAAjC,EACA,KAAKS,OAAL,CAAaS,WAAb,CAAyB,WAAzB,EAEAD,CAAI,CAAG,KAAKV,KAAL,CAAWY,MAAX,CAAkB,SAAlB,CAAP,CAEA,GAAIF,CAAI,SAAR,CAAwB,CACpBA,CAAI,CAAG,KAAKV,KAAL,CAAWa,KAAX,EAAP,CACAH,CAAI,CAACI,QAAL,CAAc,QAAd,CACH,CAED,KAAKf,OAAL,CACKE,IADL,CACU,IAAMS,CAAI,CAACT,IAAL,CAAU,GAAV,EAAeR,IAAf,CAAoB,eAApB,CADhB,EAEKqB,QAFL,CAEc,WAFd,EAE2BrB,IAF3B,CAEgC,aAFhC,CAE+C,OAF/C,CAGH,CAhBD,CAkBAG,CAAQ,CAACQ,SAAT,CAAmBW,UAAnB,CAAgC,SAASC,CAAT,CAAkBC,CAAlB,CAA2B,CACvD,GAAIC,CAAAA,CAAW,CAAGF,CAAO,CAACf,IAAR,CAAa,GAAb,CAAlB,CACIkB,CAAW,CAAGF,CAAO,CAAChB,IAAR,CAAa,GAAb,CADlB,CAGAe,CAAO,CAACL,WAAR,CAAoB,QAApB,EACAO,CAAW,CAACzB,IAAZ,CAAiB,UAAjB,CAA6B,IAA7B,EAAmCA,IAAnC,CAAwC,eAAxC,CAAyD,OAAzD,EAEAwB,CAAO,CAACH,QAAR,CAAiB,QAAjB,EACAK,CAAW,CAAC1B,IAAZ,CAAiB,eAAjB,CAAkC,MAAlC,EAEA,KAAKM,OAAL,CACKE,IADL,CACU,IAAMiB,CAAW,CAACzB,IAAZ,CAAiB,eAAjB,CADhB,EAEKkB,WAFL,CAEiB,WAFjB,EAE8BlB,IAF9B,CAEmC,aAFnC,CAEkD,MAFlD,EAIA,KAAKM,OAAL,CACKE,IADL,CACU,IAAMkB,CAAW,CAAC1B,IAAZ,CAAiB,eAAjB,CADhB,EAEKqB,QAFL,CAEc,WAFd,EAE2BrB,IAF3B,CAEgC,aAFhC,CAE+C,OAF/C,EAIA0B,CAAW,CAAC1B,IAAZ,CAAiB,UAAjB,CAA6B,GAA7B,EACA0B,CAAW,CAACC,KAAZ,EACH,CApBD,CAsBAxB,CAAQ,CAACQ,SAAT,CAAmBD,YAAnB,CAAkC,UAAW,CACzC,GAAIkB,CAAAA,CAAI,CAAG,IAAX,CAEA,KAAKrB,KAAL,CAAWsB,OAAX,CAAmB,SAASC,CAAT,CAAY,CAC3B,MAAOF,CAAAA,CAAI,CAACG,gBAAL,CAAsBxC,CAAC,CAAC,IAAD,CAAvB,CAA+BuC,CAA/B,CACV,CAFD,EAIA,KAAKvB,KAAL,CAAWyB,KAAX,CAAiB,SAASF,CAAT,CAAY,CACzB,MAAOF,CAAAA,CAAI,CAACK,cAAL,CAAoB1C,CAAC,CAAC,IAAD,CAArB,CAA6BuC,CAA7B,CACV,CAFD,CAGH,CAVD,CAYA3B,CAAQ,CAACQ,SAAT,CAAmBoB,gBAAnB,CAAsC,SAASd,CAAT,CAAea,CAAf,CAAkB,CACpD,GAAIN,CAAAA,CAAJ,CAAaU,CAAb,CAEA,OAAQJ,CAAC,CAACK,OAAV,EACI,IAAK,MAAKvB,IAAL,CAAUC,IAAf,CACA,IAAK,MAAKD,IAAL,CAAUE,EAAf,CAAmB,CAEfoB,CAAQ,CAAG,KAAK3B,KAAL,CAAW6B,KAAX,CAAiBnB,CAAjB,CAAX,CAEA,GAAiB,CAAb,GAAAiB,CAAJ,CAAoB,CAChBV,CAAO,CAAG,KAAKjB,KAAL,CAAW8B,IAAX,EACb,CAFD,IAGK,CACDb,CAAO,CAAG,KAAKjB,KAAL,CAAW+B,EAAX,CAAcJ,CAAQ,CAAG,CAAzB,CACb,CAED,KAAKZ,UAAL,CAAgBL,CAAhB,CAAsBO,CAAtB,EAEAM,CAAC,CAACS,cAAF,GACA,QACH,CACD,IAAK,MAAK3B,IAAL,CAAUG,KAAf,CACA,IAAK,MAAKH,IAAL,CAAUI,IAAf,CAAqB,CAEjBkB,CAAQ,CAAG,KAAK3B,KAAL,CAAW6B,KAAX,CAAiBnB,CAAjB,CAAX,CAEA,GAAIiB,CAAQ,GAAK,KAAK3B,KAAL,CAAWiC,MAAX,CAAkB,CAAnC,CAAsC,CAClChB,CAAO,CAAG,KAAKjB,KAAL,CAAWa,KAAX,EACb,CAFD,IAGK,CACDI,CAAO,CAAG,KAAKjB,KAAL,CAAW+B,EAAX,CAAcJ,CAAQ,CAAG,CAAzB,CACb,CAED,KAAKZ,UAAL,CAAgBL,CAAhB,CAAsBO,CAAtB,EAEAM,CAAC,CAACS,cAAF,GACA,QACH,CAlCL,CAoCH,CAvCD,CAyCApC,CAAQ,CAACQ,SAAT,CAAmBsB,cAAnB,CAAoC,SAAShB,CAAT,CAAe,CAC/C,GAAIwB,CAAAA,CAAO,CAAG,KAAKnC,OAAL,CAAaE,IAAb,CAAkB,aAAlB,CAAd,CACA,KAAKc,UAAL,CAAgBmB,CAAhB,CAAyBxB,CAAzB,CACH,CACJ,CAzIE,CA2IV,CA7IC,CAAN","sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @package   theme_snap\n * @author    Oscar Nadjar oscar.nadjar@blackboard.com\n * @copyright Copyright (c) 2019 Blackboard Inc. (http://www.blackboard.com)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * JS code to assign attributes and expected behavior for elements in the Dom regarding accessibility.\n */\ndefine(['jquery', 'core/str'],\n    function($, str) {\n        return {\n            init: function() {\n\n                str.get_strings([\n                    {key : 'accesforumstringdis', component : 'theme_snap'},\n                    {key : 'accesforumstringmov', component : 'theme_snap'},\n                    {key : 'calendar', component : 'calendar'}\n                ]).done(function(stringsjs) {\n                    // Add aria label to some DOM elements\n                    $(\"i.fa-calendar\").parent().attr(\"aria-label\", stringsjs[2]);\n                    $(\"input[name='TimeEventSelector[calendar]']\").attr('aria-label', stringsjs[2]);\n                    if ($(\"#page-mod-forum-discuss\")) {\n                        $(\".displaymode form select.custom-select\").attr(\"aria-label\", stringsjs[0]);\n                        $(\".movediscussion select.urlselect\").attr(\"aria-label\", stringsjs[1]);\n                    }\n                });\n\n                // Add accessibility for the tabs.\n                $(document).ready(function() {\n                    new Tabpanel(\"snap-pm-accessible-tab\");\n                    new Tabpanel(\"modchooser-accessible-tab\");\n                });\n\n                function Tabpanel(id) {\n                    this._id = id;\n                    this.$tpanel = $('#' + id);\n                    this.$tabs = this.$tpanel.find('.tab');\n                    this.$panels = this.$tpanel.find('.tab-pane');\n\n                    this.bindHandlers();\n                    this.init();\n                }\n\n                Tabpanel.prototype.keys = {\n                    left: 37,\n                    up: 38,\n                    right: 39,\n                    down: 40\n                };\n\n                Tabpanel.prototype.init = function() {\n                    var $tab;\n\n                    this.$panels.attr('aria-hidden', 'true');\n                    this.$panels.removeClass('active in');\n\n                    $tab = this.$tabs.filter('.active');\n\n                    if ($tab === undefined) {\n                        $tab = this.$tabs.first();\n                        $tab.addClass('active');\n                    }\n\n                    this.$tpanel\n                        .find('#' + $tab.find('a').attr('aria-controls'))\n                        .addClass('active in').attr('aria-hidden', 'false');\n                };\n\n                Tabpanel.prototype.switchTabs = function($curTab, $newTab) {\n                    var $curTabLink = $curTab.find('a'),\n                        $newTabLink = $newTab.find('a');\n\n                    $curTab.removeClass('active');\n                    $curTabLink.attr('tabindex', '-1').attr('aria-selected', 'false');\n\n                    $newTab.addClass('active');\n                    $newTabLink.attr('aria-selected', 'true');\n\n                    this.$tpanel\n                        .find('#' + $curTabLink.attr('aria-controls'))\n                        .removeClass('active in').attr('aria-hidden', 'true');\n\n                    this.$tpanel\n                        .find('#' + $newTabLink.attr('aria-controls'))\n                        .addClass('active in').attr('aria-hidden', 'false');\n\n                    $newTabLink.attr('tabindex', '0');\n                    $newTabLink.focus();\n                };\n\n                Tabpanel.prototype.bindHandlers = function() {\n                    var self = this;\n\n                    this.$tabs.keydown(function(e) {\n                        return self.handleTabKeyDown($(this), e);\n                    });\n\n                    this.$tabs.click(function(e) {\n                        return self.handleTabClick($(this), e);\n                    });\n                };\n\n                Tabpanel.prototype.handleTabKeyDown = function($tab, e) {\n                    var $newTab, tabIndex;\n\n                    switch (e.keyCode) {\n                        case this.keys.left:\n                        case this.keys.up: {\n\n                            tabIndex = this.$tabs.index($tab);\n\n                            if (tabIndex === 0) {\n                                $newTab = this.$tabs.last();\n                            }\n                            else {\n                                $newTab = this.$tabs.eq(tabIndex - 1);\n                            }\n\n                            this.switchTabs($tab, $newTab);\n\n                            e.preventDefault();\n                            return false;\n                        }\n                        case this.keys.right:\n                        case this.keys.down: {\n\n                            tabIndex = this.$tabs.index($tab);\n\n                            if (tabIndex === this.$tabs.length-1) {\n                                $newTab = this.$tabs.first();\n                            }\n                            else {\n                                $newTab = this.$tabs.eq(tabIndex + 1);\n                            }\n\n                            this.switchTabs($tab, $newTab);\n\n                            e.preventDefault();\n                            return false;\n                        }\n                    }\n                };\n\n                Tabpanel.prototype.handleTabClick = function($tab) {\n                    var $oldTab = this.$tpanel.find('.tab.active');\n                    this.switchTabs($oldTab, $tab);\n                };\n            }\n        };\n    }\n);\n"],"file":"accessibility.min.js"}