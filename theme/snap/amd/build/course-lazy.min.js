define ("theme_snap/course-lazy",["jquery","theme_snap/util","theme_snap/section_asset_management","theme_snap/course_modules"],function(a,b,c,d){return function(e){var f=this;f.courseConfig=e;var g=function(){return 0===a("body").attr("id").indexOf("page-course-view-")},h=function(c){a("#toc-search-results").html("");var d=a("#"+c.replace("#",""));b.scrollToElement(d);var e=a("#searchpin");if(!e.length){e=a("<i id=\"searchpin\"></i>")}a(d).find(".instancename").prepend(e);a(d).attr("tabindex","-1").focus();a("#course-toc").removeClass("state-visible")};this.setTOCVisibleSection=function(){var b=a(".section.main.state-visible, #coursetools.state-visible, #snap-add-new-section.state-visible").attr("id");a("#chapters li").removeClass("snap-visible-section");a("#chapters a[href$=\""+b+"\"]").parent("li").addClass("snap-visible-section");a(document).trigger("snapContentRevealed")};this.showSection=function(){if(!g()){return}var b="";if(a(".section.main.state-visible.set-by-server").length){b="#"+a(".section.main.state-visible.set-by-server").attr("id");a(".section.main.state-visible.set-by-server").removeClass("set-by-server")}else{a(".course-content .section.main, #moodle-blocks,#coursetools, #snap-add-new-section").removeClass("state-visible")}var c=location.hash.split("&"),d=c[0],e=c[1]||null;if(""!==d&&d!==b){a(b).removeClass("state-visible")}if("#coursetools"==d){a("#moodle-blocks").addClass("state-visible")}if(null!==e){a(d).addClass("state-visible");h(e)}else{a(d).addClass("state-visible").focus();i()}var f=a(".section.main.state-visible,#coursetools.state-visible,#snap-add-new-section.state-visible");if(!f.length){if(a(".section.main.current").length){a(".section.main.current").addClass("state-visible").focus()}else{a("#section-0").addClass("state-visible").focus()}i()}a("li.snap-activity:visible, li.snap-resource:visible").on("click","a.mod-link",function(){sessionStorage.setItem("lastMod",a(this).parents("[id^=module]").attr("id"))});this.setTOCVisibleSection()};var i=function(){var c=sessionStorage.getItem("lastMod");if(null===c){window.scrollTo(0,0)}else{b.scrollToElement(a("#"+c+""));sessionStorage.removeItem("lastMod")}};(function init(){c.init(f);d.init();if(f.courseConfig.enablecompletion){require(["theme_snap/course_conditionals-lazy"],function(a){a(e)})}if(g()){f.showSection();a(document).on("snapTOCReplaced",function(){f.setTOCVisibleSection()})}})();(function modchooserSectionLinks(){a(".section-modchooser-link").click(function(){var b=a(this).attr("data-section");a(".snap-modchooser-addlink").each(function(){var c=this.href.replace(/(section=)[0-9]+/ig,"$1"+b);a(this).attr("href",c)})})})()}});
//# sourceMappingURL=course-lazy.min.js.map
